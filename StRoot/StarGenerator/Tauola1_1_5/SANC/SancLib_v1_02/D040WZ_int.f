      COMPLEX*16 FUNCTION D040WZ(AQ2,AP2,AM12,AM32)
      IMPLICIT NONE
      REAL*8 EPS1,ABS1,DELTA,AQ2,AP2,Q2,P2
      REAL*8 XMIN,XMAX,STX,RFINTD,IFINTD,ARG,RED0,IMD0,RE2,RE3
      COMPLEX*16 AM12,AM32,M12,M32,DCMPLX
      COMMON /D0PAR/ M12,M32,Q2,P2
      EXTERNAL RFINTD,IFINTD
*
      Q2=AQ2
      P2=AP2
      M12=AM12
      M32=AM32
      EPS1=1D-9
      ABS1=1D-20
      DELTA=1D-12
      XMIN=DELTA
      XMAX=1D0-DELTA
      STX =.25D0*(XMAX-XMIN)     
      CALL SIMPV(XMIN,XMAX,STX,EPS1,ABS1,RFINTD,ARG,RED0,RE2,RE3)
      CALL SIMPV(XMIN,XMAX,STX,EPS1,ABS1,IFINTD,ARG,IMD0,RE2,RE3)
      D040WZ=DCMPLX(RED0,IMD0)
      RETURN
      END

      REAL*8 FUNCTION RFINTD(Y)
      IMPLICIT NONE
      REAL*8 Y,Q2,P2,DREAL
      COMPLEX*16 M12,M32,KY2,LOG
      COMMON /D0PAR/ M12,M32,Q2,P2
*
      KY2=M12*Y+M32*(1D0-Y)+Q2*Y*(1D0-Y)
      RFINTD=DREAL(1D0/(P2*KY2-M12*M32)*(LOG((KY2)/M12)+LOG(P2/M32)))
      RETURN
      END

      REAL*8 FUNCTION IFINTD(Y)
      IMPLICIT NONE
      REAL*8 Y,Q2,P2,DIMAG
      COMPLEX*16 M12,M32,KY2,LOG
      COMMON /D0PAR/ M12,M32,Q2,P2
*
      KY2=M12*Y+M32*(1D0-Y)+Q2*Y*(1D0-Y)
      IFINTD=DIMAG(1D0/(P2*KY2-M12*M32)*(LOG((KY2)/M12)+LOG(P2/M32)))
      RETURN
      END

