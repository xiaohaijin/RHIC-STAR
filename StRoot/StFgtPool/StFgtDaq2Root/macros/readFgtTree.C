/***************************************************************************
 *
 * $Id: readFgtTree.C,v 1.1 2012/01/28 09:29:26 sgliske Exp $
 * Author: S. Gliske, Jan 2012
 *
 ***************************************************************************
 *
 * Description: example of how to read the TTree in a root file
 * generated by StFgtDaq2Root.  The adc values for all timebins for
 * strips 0-9, apv 0, disc 0, are sent to standard output for the
 * first 5 events.
 *
 ***************************************************************************
 *
 * $Log: readFgtTree.C,v $
 * Revision 1.1  2012/01/28 09:29:26  sgliske
 * creation
 *
 *
 **************************************************************************/

enum { kNumTimeBins = 7, kNumChans = 128, kNumApv = 10, kNumQuad = 3, kNumStripsPerEvent = 26880 };

struct chan_t {
   Int_t tb[kNumTimeBins];
};

struct apv_t {
   chan_t chan[kNumChans];
};

struct quad_t {
   apv_t apv[kNumApv];
};

struct cosmicFgt_t {
   quad_t quad[kNumQuad];
};

readFgtTree( const Char_t *file = "fgtTest.root" ) {
   TFile *f = new TFile( file, "READ");
   TTree *tree = f->Get("fgtTree");
   if(!tree){
      cout << "error" << endl;
      return;
   };

   cosmicFgt_t fgtData;

   tree->SetBranchAddress("branch", &fgtData );

   for( Int_t ev = 0; ev<5; ++ev ){
      tree->GetEvent(ev);
      Int_t quad = 0;
      Int_t apv = 2;
      
      for( Int_t chan = 0; chan < 10; ++chan ){
         cout << "event " << ev << ", quad " << quad << ", apv " << apv
              << ", chan " << chan << " values ";
         for( Int_t tb = 0; tb < 7; ++tb )
            cout  << fgtData.quad[0].apv[apv].chan[chan].tb[tb] << ' ';
         cout << endl;
      };
   };
   f->Close();
};
